language: ruby
cache: bundler
sudo: false
rvm:
  - 2.2.2
before_install:
  - apt-get update -qq
  - apt-get install -qq imagemagick slapd ldap-utils
before_script:
  - 'cp config/application.example.yml config/application.yml'
  - "psql -c 'create database mawidabp_test;' -U postgres"
  - 'bundle exec rake db:migrate'
  - 'slapd -f test/fixtures/ldap/slapd.conf -h ldap://localhost:3389'
  - 'bundle exec rake ldap:reset'
