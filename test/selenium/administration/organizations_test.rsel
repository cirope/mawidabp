organization_name = "AAANew Organization #{rand(100000)}"
organization_prefix = "new-prefix-#{rand(100000)}"
business_unit = "New Business Unit #{rand(100000)}"

open :controller => :organizations, :action => :index
assert_title "glob:Mawida <*> | #{I18n.t('organization.index_title')}"
click_and_wait "link=#{I18n.t('label.new')}"
assert_title "glob:Mawida <*> | #{I18n.t('organization.new_title')}"
type 'organization_name', organization_name
type 'organization_prefix', organization_prefix
click "link=#{I18n.t('organization.add_business_unit')}"
wait_for_element_present 'css=.business_unit'
type 'css=.business_unit input[type=text]', business_unit
click_and_wait 'organization_submit'
assert_title "glob:Mawida <*> | #{I18n.t('organization.index_title')}"
verify_text 'css=#notice > p', I18n.t('organization.correctly_created')
assert_text_present organization_name
click_and_wait "css=img[alt='#{I18n.t('label.edit')}']"
assert_title "glob:Mawida <*> | #{I18n.t('organization.edit_title')}"
assert_element_not_present 'organization_prefix'
verify_value 'organization_name', organization_name
type 'organization_name', organization_name.sub(/New/, 'Updated')
verify_value 'organization_business_units_attributes_0_name', business_unit
type 'organization_business_units_attributes_0_name',
  business_unit.sub(/^New/, 'Updated')
click_and_wait 'organization_submit'
verify_text 'css=#notice > p', I18n.t('organization.correctly_updated')
assert_text_present organization_name.sub(/New/, 'Updated')
click_and_wait "css=img[alt='#{I18n.t('label.show')}']"
assert_title "glob:Mawida <*> | #{I18n.t('organization.show_title')}"