+function () {
  <% if FINDING_ANSWER_COMMITMENT_SUPPORT && @commitment_date.future? %>
    var $container = $('[data-answer-commitment]')

    <% if params[:show].present? %>
      <%= simple_fields_for :finding_answer do |f| %>
        <%= f.simple_fields_for :commitment_support_attributes, CommitmentSupport.new do |cs_f| %>
          $container.html('<%= j render('commitment', f: cs_f) %>').removeAttr('hidden')
          $container.find('[data-autofocus]').focus()
        <% end %>
      <% end %>
    <% else %>
      <%= simple_fields_for :finding, @finding do |f| %>
        <%= f.simple_fields_for :finding_answers_attributes, FindingAnswer.new, index: @index do |fa_f| %>
          <%= fa_f.simple_fields_for :commitment_support_attributes, CommitmentSupport.new do |cs_f| %>
            $container.html('<%= j render('commitment', f: cs_f) %>').removeAttr('hidden')
            $container.find('[data-autofocus]').focus()
          <% end %>
        <% end %>
      <% end %>
    <% end %>
  <% end %>
}()
