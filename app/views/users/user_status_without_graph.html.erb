<div class="page-header">
  <h2><%= @user.informal_name %></h2>
</div>

<div class="row">
  <div class="col-md-4">
    <h5>
      <%= textilize_without_paragraph(t('user.high_risk_weaknesses',
        :count => @filtered_weaknesses.with_highest_risk.count)) %>
    </h5>
    <table class="table table-condensed table-striped">
      <% Weakness.weaknesses_for_graph(@filtered_weaknesses.with_highest_risk).each do |weakness| %>
        <tr>
          <td><%= weakness[:label] %></td>
          <td>
            <% if @filtered_weaknesses.with_highest_risk.count > 0 %>
              <%= "  #{weakness[:value]} (#{(weakness[:value].to_f / @filtered_weaknesses.with_highest_risk.count * 100).round(2)}%)" %>
            <% else %>
              <%= "0" %>
            <% end %>
          </td>
        </tr>
      <% end %>
    </table>
  </div>

  <div class="col-md-4">
    <h5>
      <%= user_weaknesses_links(@user) %>
    </h5>
    <table class="table table-condensed table-striped">
      <% Weakness.weaknesses_for_graph(@filtered_weaknesses).each do |weakness| %>
        <tr>
          <td><%= weakness[:label] %></td>
          <td>
            <% if @filtered_weaknesses.count > 0 %>
              <%= "  #{weakness[:value]} (#{(weakness[:value].to_f / @filtered_weaknesses.count * 100).round(2)}%)" %>
            <% else %>
              <%= "0" %>
            <% end %>
          </td>
        </tr>
      <% end %>
    </table>
  </div>

  <div class="col-md-4">
    <h5>
      <%= textilize_without_paragraph(t('user.pending_weaknesses_detailed',
        :count => @filtered_weaknesses.with_pending_status.count)) %>
    </h5>
    <table class="table table-condensed table-striped">
      <% Weakness.pending_weaknesses_for_graph(@filtered_weaknesses).each do |weakness| %>
        <tr>
          <td><%= weakness[:label] %></td>
          <td>
            <% if @filtered_weaknesses.with_pending_status.count > 0 %>
              <%= "  #{weakness[:value]} (#{(weakness[:value].to_f / @filtered_weaknesses.with_pending_status.count * 100).round(2)}%)" %>
            <% else %>
              <%= "0" %>
            <% end %>
          </td>
        </tr>
      <% end %>
    </table>
  </div>
</div>

<hr />

<%= link_to_show user_path(@user) %> |
<%= link_to t('label.list'), users_path %> |
<%= link_to t('user.graph_mode'), user_status_user_path %> |
<%= link_to_back %>
