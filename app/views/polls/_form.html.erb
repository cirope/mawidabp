<%= simple_form_for @poll do |f| %>
  <%= render 'shared/error_explanation', f: f %>

  <% if @poll.persisted? %>
    <div class="page-header">
      <h1><%= Question.model_name.human count: 0 %></h1>
    </div>

    <%= f.simple_fields_for :answers do |a_f| %>
      <%= render 'answer', f: a_f %>
    <% end %>

    <hr />
  <% end %>

  <div class="form-inputs">
    <div class="row">
      <div class="col-md-6">
        <% if @poll.new_record? %>
          <%= f.input :user, autofocus: true, input_html: {
            title: t('label.search'),
            value: @poll.user.try(:label),
            data: {
              'autocomplete-url' => polls_users_path,
              'autocomplete-id-target' => '#poll_user_id'
            }
          } %>
          <%= f.input :user_id, as: :hidden %>
          <%= f.association :questionnaire,
            collection: Questionnaire.list.pluck(:name, :id), prompt: true
          %>
        <% else %>
          <%= f.input :comments, label: "#{Poll.human_attribute_name :comments} (#{t 'label.optional'})" %>
        <% end %>
      </div>
    </div>
  </div>

  <hr />
  <div class="form-actions">
    <%= f.input :lock_version, as: :hidden %>
    <%= f.submit class: 'btn btn-default btn-primary' %>
    <div class="pull-right"><%= yield :form_actions %></div>
  </div>
<% end %>
