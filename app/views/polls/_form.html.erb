<%= simple_form_for(@poll) do |f| %>
  <%= render 'shared/error_explanation', f: f %>
  <% unless @poll.new_record? %>
    <h1><%= t 'activerecord.attributes.questionnaire.questions' %></h1>

    <hr />
    <%= f.simple_fields_for :answers do |a_f| %>
      <%= render 'answer', f: a_f %>
    <% end %>

    <hr />
  <% end %>

  <div class="form-inputs">
    <div class="row">
      <div class="col-md-6">
        <% if @poll.new_record? %>
          <%= f.input :user, input_html: {
            id: "user_id_#{@poll.id}",
            class: 'autocomplete_field',
            title: t('label.search'),
            data: {
              'autocomplete-params' => ({ user_id: @poll.id } unless @poll.new_record?),
              'autocomplete-url' => polls_users_path,
              'autocomplete-id-target' => "#hidden_user_id_#{@poll.id}"
            }
          } %>
          <%= f.input :user_id, as: :hidden, input_html: {
            class: 'autocomplete_id', id: "hidden_user_id_#{@poll.id}"
          } %>
          <%= f.input :questionnaire_id, collection: Questionnaire.list.map { |q| [q.name, q.id] },
            prompt: true
          %>
        <% else %>
          <%= f.input :comments, label: "#{Poll.human_attribute_name :comments} (#{t 'label.optional'})" %>
        <% end %>
      </div>
    </div>
  </div>

  <hr />
  <div class="form-actions form-footer">
    <div class="pull-right"><%= yield :form_actions %></div>
    <%= f.input :lock_version, as: :hidden %>
    <%= f.submit class: 'btn btn-default btn-primary' %>
  </div>
<% end %>
