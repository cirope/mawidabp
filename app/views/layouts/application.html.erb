<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<% @title ||= t("actioncontroller.#{controller.controller_name}") %>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title><%= t(:app_name) %><%= " &lt;#{@auth_organization.name}&gt;" if @auth_organization %> | <%= @title %></title>
    <%= stylesheet_link_tag 'common', :media => :all %>
    <%= javascript_include_tag :defaults, :cache => 'main' %>
    <%= javascript_include_tag 'popup.js' %>
    <%= calendar_date_select_includes 'silver', :locale => (@auth_user.language if @auth_user) %>
    <%= javascript_tag do %>
      <%= "State.unsavedDataWarning = '#{t(:'message.unsaved_data_warning')}';" %>
      <%= yield :js_extra %>
    <% end %>
  </head>
  <body>
    <div id="loading" style="display: none;">
      <%= image_tag 'loading.gif', :size => '43x11', :alt => t(:'message.loading') %>
    </div>
    <% if @auth_organization && parameter_in(@auth_organization.id, :security_session_expire_time).to_i > 0 %>
      <%= render :partial => 'shared/time_left', :locals =>
        {:time_left => parameter_in(@auth_organization.id, :security_session_expire_time).to_i} %>
    <% end %>
    <div id="main_container">
      <% if @auth_user && @auth_user.password %>
        <div id="menu_container">
          <%= render :partial => "shared/#{@auth_user.get_menu if @auth_user}",
            :locals => {:user => @auth_user, :organization => @auth_organization} %>
        </div>
      <% else %>
        <div id="menu"></div>
      <% end %>
      <div id="page">
        <div id="app_content">
          <%= yield %>
        </div>
        <div style="clear: both; margin: 0px; padding: 0px;">&nbsp;</div>
        <%= render :partial => 'shared/notice' if flash[:notice] %>
        <%= render :partial => 'shared/alert' if flash[:alert] %>
      </div>
    </div>
    <%= javascript_tag do %>
      <%= yield :js_extra_bottom %>
    <% end %>
    <%= yield :extra_html_bottom %>
  </body>
</html>